<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:cxf="http://camel.apache.org/schema/cxf"
	   xmlns:camelcxf="http://camel.apache.org/schema/blueprint/cxf"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:sec="http://cxf.apache.org/configuration/security"
	   xmlns:http-conf="http://cxf.apache.org/transports/http/configuration"
	   xmlns:http="http://cxf.apache.org/transports/http/configuration"
	   xmlns:cxf-core="http://cxf.apache.org/core"
	   xsi:schemaLocation="
	    http://cxf.apache.org/configuration/security
	    http://cxf.apache.org/schemas/configuration/security.xsd
	    http://cxf.apache.org/transports/http/configuration
	    http://cxf.apache.org/schemas/configuration/http-conf.xsd
    	http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd
    	http://www.springframework.org/schema/beans      
    	http://www.springframework.org/schema/beans/spring-beans.xsd      
    	http://camel.apache.org/schema/spring 
    	http://camel.apache.org/schema/spring/camel-spring.xsd      
    	http://camel.apache.org/schema/cxf 
    	http://camel.apache.org/schema/cxf/camel-cxf-2.8.3.xsd">

	<cxf-core:bus>
		<cxf-core:features>
			<cxf-core:logging />
		</cxf-core:features>
	</cxf-core:bus>

	<bean id="debugProcessor" class="ar.com.edenor.ocp.processors.DebugProcessor" />
	<bean id="wsResponseProcessor" class="ar.com.edenor.ocp.processors.WSMockResponseProcessor" />
	<bean id="setWebServiceParameterProcessor"	class="ar.com.edenor.ocp.processors.SetWebServiceParameterProcessor" />
	<bean id="setWebServiceResponseProcessor"	class="ar.com.edenor.ocp.processors.SetWebServiceResponseProcessor" />
	<bean id="jsonProvider" class="com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider" />
	<bean id="mockKTADTO" class="ar.com.edenor.ocp.model.MockKTADTO" />

<!--	<cxf:cxfEndpoint id="soapmockKTAEndpoint"
					 serviceClass="ar.com.edenor.ocp.model.MockKTADTO"
					 address="${ws.mockKTA.endpointAddress}">
		<cxf:properties>
			<entry key="dataFormat" value="POJO"/>
			<entry key="wrapped" value="true"/>
		</cxf:properties>
	</cxf:cxfEndpoint>-->

<!--
	<cxf:rsClient id="actualizarEstadoMockKTA" address="/mockKTA"
					 serviceClass="ar.com.edenor.ocp.model.MockKTADTO">
	</cxf:rsClient>
-->

	<cxf:cxfEndpoint id="actualizarEstadoMockKTA" address="/mockKTA"
					 serviceClass="ar.com.edenor.ocp.service.MockKtaService">
	</cxf:cxfEndpoint>
<!--	<cxf:cxfEndpoint id="routerEndpoint"
					 address="/CamelContext/mockKTA"
					 serviceClass="ar.com.edenor.ocp.model.MockKTADTO">
		<cxf:properties>
			<entry key="wrapped" value="true"/>
			<entry key="dataFormat" value="POJO"/>
		</cxf:properties>
	</cxf:cxfEndpoint>-->



	<camelContext id="camel" xmlns="http://camel.apache.org/schema/spring">

		<dataFormats>
			<json id="json" prettyPrint="true" library="Jackson"/>
			<json id="jsonResponse" prettyPrint="true" library="Jackson" useList="true"
				  unmarshalTypeName="ar.com.edenor.ocp.api.StandardErrorResponse"/>
		</dataFormats>

		<!-- **** Rest Services *** -->
		<restConfiguration bindingMode="auto"
						   component="servlet"
						   port="9090"
						   apiContextPath="/api-doc"
						   skipBindingOnErrorCode="false"
		                   >
			<dataFormatProperty key="prettyPrint"
									  value="true" />
			<apiProperty key="api.title" value="mockKTA api"/>
			<apiProperty key="api.version" value="1.0"/>
			<apiProperty key="cors" value="true"/>

		</restConfiguration>
				

		<rest path="/" apiDocs="true" >
			<post uri="mockKTA" type="ar.com.edenor.ocp.api.MockKTARequestParamDTO" consumes="json" produces="json" outType="ar.com.edenor.ocp.api.MockKTARequestResponseDTO">
				<to uri="direct:mockKTA_route" />
			</post>
		</rest>

<!--		<route>
			<from uri="cxf:bean:routerEndpoint" />
			<to uri="bean:wsResponseProcessor"/>
		</route>-->


		<route id="mockKTA_route">

			<from uri="direct:mockKTA_route"/>
			<process ref="debugProcessor"/>
			<!--<process ref="setWebServiceParameterProcessor" />-->
			<process ref="setWebServiceResponseProcessor" />

		</route>
	</camelContext>
</beans>